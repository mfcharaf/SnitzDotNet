var emoticons;var userTheme="BlueGray";var emtagname_re=/^\/?(?:b|i|u|pre)$/;var smilefmt_re=/\/?(?:\[([a-z0-9?}/!~|\^\*:;\(\)]{1,16})\])|(\[\/noparse])/ig;function emoticon(c,a,b){this.name=c;this.code=a;this.image=b}function emtaginfo_t(a,b){this.bbtag=a;this.etag=b}function emValidTag(a){if(!a||!a.length){return false}var b=emoticons.filter(function(c){return c.code==a});if(b.length){return true}else{return false}}function emoticonToImage(d,b,c,e,f){if(emValidTag(b)){if(noparse){return"["+b+"]"}if(opentags.length&&opentags[opentags.length-1].bbtag=="url"&&urlstart>=0){return"["+b+"]"}var a=emoticons.filter(function(h){return h.code==b});if(a.length){if(a[0].code=="noparse"){noparse=true;return"[noparse]"}var g='<img alt="'+a[0].name+'" class="emoticon" src="/app_themes/'+userTheme+"/images/emoticons/"+a[0].image+'"/>';return g}}if(emValidTag(c)){if(noparse){if(c=="[/noparse]"){noparse=false;return c}return"[/"+m4+"]"}}if(b=="/noparse"){noparse=false;return"[/noparse]"}return d}function fillEmoticons(){emoticons.push(new emoticon("smile",":)","icon_smile.gif"));emoticons.push(new emoticon("eightball","8","icon_smile_8ball.gif"));emoticons.push(new emoticon("angry",":(!","icon_smile_angry.gif"));emoticons.push(new emoticon("approve","^","icon_smile_approve.gif"));emoticons.push(new emoticon("bigsmile",":D","icon_smile_big.gif"));emoticons.push(new emoticon("bigeyes","88","icon_smile_bigeyes.gif"));emoticons.push(new emoticon("blackeye","B)","icon_smile_blackeye.gif"));emoticons.push(new emoticon("blush",":I","icon_smile_blush.gif"));emoticons.push(new emoticon("boggled",":~","icon_smile_boggled.gif"));emoticons.push(new emoticon("clown",":o)","icon_smile_clown.gif"));emoticons.push(new emoticon("cool","8D","icon_smile_cool.gif"));emoticons.push(new emoticon("cyclops","o)","icon_smile_cyclops.gif"));emoticons.push(new emoticon("dead","xx(","icon_smile_dead.gif"));emoticons.push(new emoticon("deadgreen","XX()","icon_smile_dead_green.gif"));emoticons.push(new emoticon("dissapprove","v","icon_smile_dissapprove.gif"));emoticons.push(new emoticon("dissapprove2","V","icon_smile_dissapprove.gif"));emoticons.push(new emoticon("evil","}:)","icon_smile_evil.gif"));emoticons.push(new emoticon("kisses",":x","icon_smile_kisses.gif"));emoticons.push(new emoticon("kisses2",":X","icon_smile_kisses.gif"));emoticons.push(new emoticon("mean",":/","icon_smile_mean.gif"));emoticons.push(new emoticon("question","?","icon_smile_question.gif"));emoticons.push(new emoticon("sad",":(","icon_smile_sad.gif"));emoticons.push(new emoticon("shock",":o","icon_smile_shock.gif"));emoticons.push(new emoticon("shocked",":0","icon_smile_shock.gif"));emoticons.push(new emoticon("shy","8)","icon_smile_shy.gif"));emoticons.push(new emoticon("sleepy","|)","icon_smile_sleepy.gif"));emoticons.push(new emoticon("tongue",":P","icon_smile_tongue.gif"));emoticons.push(new emoticon("tongue2",":p","icon_smile_tongue.gif"));emoticons.push(new emoticon("wink",";)","icon_smile_wink.gif"));emoticons.push(new emoticon("","noparse",""));emoticons.push(new emoticon("","[/noparse]",""));emoticons.push(new emoticon("delete","delete","delete.png"));emoticons.push(new emoticon("edit","edit","edit.png"));emoticons.push(new emoticon("pencil","pencil","pencil.png"));emoticons.push(new emoticon("lock","lock","lock.png"))}function parseEmoticon(c,b){var d,a,e;userTheme=b;if(emoticons==null||emoticons.length){emoticons=new Array(0);fillEmoticons()}if(opentags==null||opentags.length){opentags=new Array(0)}d=c.replace(smilefmt_re,emoticonToImage);if(noparse){noparse=false}if(opentags.length){a=new String();if(opentags[opentags.length-1].bbtag=="url"){opentags.pop();a+='">'+c.substr(urlstart,c.length-urlstart)+"</a>"}while(opentags.length){a+=opentags.pop().etag}}return a?d+a:d};